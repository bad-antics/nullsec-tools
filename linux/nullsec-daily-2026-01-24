#!/bin/bash
# NullSec Security Scanner - Generated 2026-01-24
# %DESC%

VERSION="1.0.0-2026-01-24"
TARGET="${1:-localhost}"

echo "╔═══════════════════════════════════════╗"
echo "║   NullSec Security Scanner v$VERSION  ║"
echo "╚═══════════════════════════════════════╝"
echo ""
echo "Target: $TARGET"
echo "Date: $(date)"
echo ""

# Port scanning
echo "[*] Scanning common ports..."
for port in 21 22 23 25 53 80 110 143 443 445 993 995 3306 3389 5432 8080; do
    timeout 1 bash -c "echo >/dev/tcp/$TARGET/$port" 2>/dev/null && \
        echo "  [OPEN] Port $port"
done

# Service detection
echo ""
echo "[*] Detecting services..."
command -v nmap &>/dev/null && nmap -sV --top-ports 20 "$TARGET" 2>/dev/null | grep -E "^[0-9]+"

# SSL check
if timeout 2 bash -c "echo >/dev/tcp/$TARGET/443" 2>/dev/null; then
    echo ""
    echo "[*] SSL Certificate Info:"
    echo | openssl s_client -connect "$TARGET:443" 2>/dev/null | \
        openssl x509 -noout -dates -subject 2>/dev/null
fi

echo ""
echo "[✓] Scan complete"
